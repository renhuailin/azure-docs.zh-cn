---
title: 如何为自定义语音准备数据 - 语音服务
titleSuffix: Azure Cognitive Services
description: 使用语音服务为品牌创建自定义语音。 在你提供工作室录制内容和关联的脚本后，服务将生成针对录制的语音优化的独特语音模型。 使用此语音可以合成产品、工具和应用程序中的语音。
services: cognitive-services
author: laujan
manager: nitinme
ms.service: cognitive-services
ms.subservice: speech-service
ms.topic: conceptual
ms.date: 11/04/2019
ms.author: lajanuar
ms.openlocfilehash: 74f23dd6a7629e98189f73ebc305755d70f3c7a1
ms.sourcegitcommit: e7d500f8cef40ab3409736acd0893cad02e24fc0
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/13/2021
ms.locfileid: "122068991"
---
# <a name="prepare-training-data"></a>准备训练数据

准备好为应用程序创建自定义的“文本转语音”语音后，第一步是收集音频录制内容和关联的脚本，开始训练语音模型。 语音服务会使用此数据创建与录制内容中的语音相匹配的、经过优化的独特语音。 训练该语音后，可以开始合成应用程序中的语音。

## <a name="voice-talent-verbal-statement"></a>配音员语音语句

在训练自己的“文本转语音”语音模型之前，需要创建音频录制内容和关联的文本听录内容。 在此页上，我们将查看数据类型及其使用方式和管理方式。

> [!NOTE]
> 若要训练神经语音，必须使用配音员录制的音频文件创建配音员配置文件，前提是配音员同意授权使用其语音数据来训练自定义语音模型。 准备录制脚本时，请确保包含以下句子。

> “我[说出你的名字和姓氏]知道，[说出公司名称]将使用我的声音录音来创建和使用我的声音的合成版本。”
这句话将用于验证训练数据是否由作出同意的那个人完成。 在此处详细了解[配音员验证](/legal/cognitive-services/speech-service/custom-neural-voice/data-privacy-security-custom-neural-voice?context=%2fazure%2fcognitive-services%2fspeech-service%2fcontext%2fcontext)。

> 自定义神经语音只能在有限的访问权限下使用。 请确保你了解[负责任的 AI 使用原则](/legal/cognitive-services/speech-service/custom-neural-voice/limited-access-custom-neural-voice?context=%2fazure%2fcognitive-services%2fspeech-service%2fcontext%2fcontext)并[在此处应用访问权限](https://aka.ms/customneural)。 

## <a name="types-of-training-data"></a>训练数据类型

语音训练数据集包括音频录制内容，以及一个包含关联听录内容的文本文件。 每个音频文件应包含单个言语（对话系统的单个句子或单个轮次），长度不能超过 15 秒。

在某些情况下，你可能尚未准备好合适的数据集，于是希望使用可用的音频文件（或长或短，包含或不包含脚本）来测试自定义神经语音训练。 我们提供了所需的工具 (beta) 来帮助你将音频分段成言语，并使用[批量听录 API](batch-transcription.md) 来准备脚本。

下表列出了数据类型，以及如何使用每种类型来创建自定义的“文本转语音”语音模型。

| 数据类型 | 说明 | 何时使用 | 需要额外的处理 |
| --------- | ----------- | ----------- | --------------------------- |
| **单个言语 + 匹配的脚本** | 单个言语形式的音频文件 (.wav) 集合 (.zip)。 每个音频文件的长度不应超过 15 秒，并与带格式的脚本 (.txt) 配对。 | 包含匹配脚本的专业录制内容 | 做好训练准备。 |
| **长音频 + 脚本 (beta)** | 未分段的长音频文件（超过 20 秒）集合 (.zip)，与包含所有口语的脚本集合 (.zip) 配对。 | 有音频文件和匹配的脚本，但它们未分段成言语。 | 分段（使用批量听录）。<br>根据需要进行音频格式转换。 |
| **仅限音频 (beta)** | 不包含脚本的音频文件集合 (.zip)。 | 只有音频文件，没有脚本。 | 分段 + 脚本生成（使用批量听录）。<br>根据需要进行音频格式转换。|

文件应按类型分组成数据集，并作为 zip 文件上传。 每个数据集只能包含一种数据类型。

> [!NOTE]
> 每个订阅允许导入的数据集的最大数目为 10 个（对于免费订阅 (F0) 用户）和 500 个（对于标准订阅 (S0) 用户）.zip 文件。

## <a name="individual-utterances--matching-transcript"></a>单个言语 + 匹配的脚本

可通过两种方式准备单个言语和匹配脚本的录制内容。 先编写脚本，然后让语音专家朗读该脚本；或者使用公开提供的音频，然后将其转录成文本。 如果是后一种情况，请编辑音频文件中的不流畅之处，例如“嗯”之类的无意义声音、口吃音、喃喃自语或错读音。

若要生成好的语音模型，请在安静的房间中使用优质麦克风创建录制内容。 必须确保使用一致的音量、语速、语调以及有表现力的语音方式。

> [!TIP]
> 若要创建生产用的语音，建议使用专业录音棚和语音专家。 有关详细信息，请参阅[录制语音示例以创建自定义神经语音](record-custom-voice-samples.md)。

### <a name="audio-files"></a>音频文件

每个音频文件应包含单个言语（对话系统的单个句子或单个轮次），长度不超过 15 秒。 所有文件必须使用相同的口语。 不支持自定义的多语言“文本转语音”语音，但“中-英”双语除外。 每个音频文件必须使用扩展名为 .wav 的唯一数字文件名。

准备音频时，请遵循这些指导原则。

| 属性 | 值 |
| -------- | ----- |
| 文件格式 | RIFF (.wav)，分组成 .zip 文件 |
| 采样率 | 至少 16,000 Hz。 若要创建神经语音，需要 24,000 Hz。 |
| 示例格式 | PCM，16 位 |
| 文件名 | 数字，扩展名为 .wav。 不允许重复的文件名。 |
| 音频长度 | 短于 15 秒 |
| 存档格式 | .zip |
| 最大存档大小 | 2048 MB |

> [!NOTE]
> 采样率低于 16,000 Hz 的 .wav 文件将被拒绝。 如果 .zip 文件包含具有不同采样率的 .wav 文件，只会导入等于或高于 16,000 Hz 的波形。 门户目前可以导入的 .zip 存档最多只能为 2048 MB。 但是，可以上传多个存档。

> [!NOTE]
> 自定义神经语音的默认采样频率为 24,000 Hz。  采样频率低于 16,000 Hz 的 .wav 文件将向上采样至 24,000 Hz，以训练神经语音。  建议对训练数据使用 24,000 Hz 的采样频率。

### <a name="transcripts"></a>脚本

听录文件是一个纯文本文件。 请遵循以下指导原则准备听录内容。

| 属性 | 值 |
| -------- | ----- |
| 文件格式 | 纯文本 (.txt) |
| 编码格式 | ANSI/ASCII、UTF-8、UTF-8-BOM、UTF-16-LE 或 UTF-16-BE。 对于 zh-CN，不支持 ANSI/ASCII 和 UTF-8 编码。 |
| 每行的话语数 | **1** - 听录文件的每一行应包含一个音频文件的名称，后接相应的听录。 文件名和听录应以制表符 (\t) 分隔。 |
| 文件大小上限 | 2048 MB |

以下示例演示如何在一个 .txt 文件中按言语组织脚本：

```
0000000001[tab] This is the waistline, and it's falling.
0000000002[tab] We have trouble scoring.
0000000003[tab] It was Janet Maslin.
```
必须确保脚本是相应音频的完全准确的听录。 脚本中的错误会在训练期间造成质量损失。

## <a name="long-audio--transcript-beta"></a>长音频 + 脚本 (beta)

在某些情况下，你可能没有可用的分段音频。 我们将通过 Speech Studio 提供一个服务 (beta)，帮助将长音频文件分段和创建听录内容。 请记住，此服务会产生语音转文本订阅使用费。

> [!NOTE]
> 长音频分段服务将利用语音转文本的批量听录功能，该功能仅支持标准订阅 (S0) 用户。 在处理分段期间，还会将音频文件和脚本发送到自定义语音服务来优化识别模式，以改善数据的准确性。 在此过程中不会保留任何数据。 分段完成后，只会存储已分段的言语及其映射脚本供你下载和训练。

### <a name="audio-files"></a>音频文件

准备要分段的音频时，请遵循这些指导原则。

| 属性 | 值 |
| -------- | ----- |
| 文件格式 | RIFF (.wav)，在 PCM 中或 .mp3 中的采样率至少为 16 khz 16 位，比特率至少为 256 KBps，分组成 .zip 文件 |
| 文件名 | 支持 ASCII 和 Unicode 字符。 不允许重复的名称。 |
| 音频长度 | 长于 20 秒 |
| 存档格式 | .zip |
| 最大存档大小 | 2048 MB |

> [!NOTE]
> 自定义神经语音的默认采样频率为 24,000 Hz。  采样频率低于 16,000 Hz 的 .wav 文件将向上采样至 24,000 Hz，以训练神经语音。  建议对训练数据使用 24,000 Hz 的采样频率。

所有音频文件应分组成一个 .zip 文件。 可以将 .wav 文件和 .mp3 文件放入一个音频 zip。 例如，上传的 zip 文件可以包含一个名为“kingstory.wav”且长度为 45 秒的音频文件，以及一个名为“queenstory.mp3”且长度为 200 秒的音频。 处理后，所有 .mp3 文件将转换为 .wav 格式。

### <a name="transcripts"></a>脚本

必须根据此表中所列的规范准备脚本。 每个音频文件必须与某个脚本匹配。

| 属性 | 值 |
| -------- | ----- |
| 文件格式 | 纯文本 (.txt)，分组成 .zip |
| 文件名 | 使用与匹配的音频文件相同的名称 |
| 编码格式 | 仅限 UTF-8-BOM |
| 每行的话语数 | 无限制 |
| 文件大小上限 | 2048 MB |

此数据类型的所有脚本文件应分组成一个 zip 文件。 例如，你已上传一个 zip 文件，其中包含一个名为“kingstory.wav”、长度为 45 秒的音频文件，以及一个名为“queenstory.mp3”、长度为 200 秒的文件。 现在，你需要上传另一个 zip 文件，其中包含两个脚本，一个名为“kingstory.txt”，另一个名为“queenstory.txt”。 在每个纯文本文件中，需要为匹配的音频提供完全正确的听录内容。

成功上传数据集后，我们会帮助你根据提供的脚本将音频文件分段成言语。 可以通过下载数据集来检查分段的言语和匹配的脚本。 系统会自动将唯一 ID 分配到分段的言语。 请确保提供的脚本完全准确，这一点非常重要。 如果脚本中有错误，在音频分段期间可能会降低准确性，并在后续的训练阶段进一步造成质量损失。

## <a name="audio-only-beta"></a>仅限音频 (beta)

如果音频录制内容没有听录，请使用“仅限音频”选项上传数据。 我们的系统可帮助你分段和听录音频文件。 请记住，此服务会产生语音转文本订阅使用费。

准备音频时，请遵循这些指导原则。

> [!NOTE]
> 长音频分段服务将利用语音转文本的批量听录功能，该功能仅支持标准订阅 (S0) 用户。

| 属性 | 值 |
| -------- | ----- |
| 文件格式 | RIFF (.wav)，在 PCM 中或 .mp3 中的采样率至少为 16 khz 16 位，比特率至少为 256 KBps，分组成 .zip 文件 |
| 文件名 | 支持 ASCII 和 Unicode 字符。 不允许重复的名称。 |
| 音频长度 | 长于 20 秒 |
| 存档格式 | .zip |
| 最大存档大小 | 2048 MB |

> [!NOTE]
> 自定义神经语音的默认采样频率为 24,000 Hz。  采样频率低于 16,000 Hz 的 .wav 文件将向上采样至 24,000 Hz，以训练神经语音。  建议对训练数据使用 24,000 Hz 的采样频率。

所有音频文件应分组成一个 .zip 文件。 成功上传数据集后，我们会基于语音批量听录服务帮助你将音频文件分段成言语。 系统会自动将唯一 ID 分配到分段的言语。 匹配的脚本将通过语音识别生成。 处理后，所有 .mp3 文件将转换为 .wav 格式。 可以通过下载数据集来检查分段的言语和匹配的脚本。

## <a name="next-steps"></a>后续步骤

- [创建和使用语音模型](how-to-custom-voice-create-voice.md)
- [如何录制语音示例](record-custom-voice-samples.md)