### YamlMime:FAQ
metadata:
  title: 指标顾问常见问题解答
  titleSuffix: Azure Cognitive Services
  description: 有关指标顾问服务的常见问题解答。
  services: cognitive-services
  author: mrbullwinkle
  manager: nitinme
  ms.service: applied-ai-services
  ms.subservice: metrics-advisor
  ms.topic: conceptual
  ms.date: 11/05/2020
  ms.author: mbullwin
  ms.openlocfilehash: fb5659f5432225c6b6e33dd8480377763697190f
  ms.sourcegitcommit: 03f0db2e8d91219cf88852c1e500ae86552d8249
  ms.translationtype: HT
  ms.contentlocale: zh-CN
  ms.lasthandoff: 08/27/2021
  ms.locfileid: "123029838"
title: 指标顾问常见问题解答
summary: ''
sections:
- name: 基本概念
  questions:
  - question: >
      什么是多维时序数据？
    answer: >
      请参阅词汇表中的[多维指标](glossary.md#multi-dimensional-metric)定义。
  - question: >
      指标顾问启动异常情况检测需要多少数据？
    answer: >
      至少需要一个数据点才能触发异常情况检测。 但这并不能实现最佳的准确性。 此服务将使用在创建数据馈送时指定为“填充间隙”规则的值来假定以前的数据点的时间窗口。


      建议在要检测的时间戳之前包含一些数据。

      根据数据的粒度，建议的数据量如下变化。


      | 粒度 | 建议的检测数据量 |

      | ----------- | ------------------------------------- |

      | 少于 5 分钟 | 4 天的数据 |

      | 5 分钟至 1 天 | 28 天的数据 |

      | 1 天以上至 31 天 | 4 年的数据 |

      | 大于 31 天 | 48 年的数据 |
  - question: >
      指标处理哪些数据以及如何保留数据？
    answer: "- 指标顾问处理从客户的数据源收集的时序数据，历史数据用于模型选择，并确定所需的数据边界。 \n- 客户的时序数据和推理结果将存储在服务中。 指标顾问不会在客户部署服务实例的区域之外存储或处理客户数据。\n"
  - question: >
      为什么指标顾问无法从历史数据中检测到异常？
    answer: >
      指标顾问旨在检测实时传送视频流数据。 此服务将回顾并对其运行异常情况检测的历史数据的最大长度受到限制。 这意味着只有在某个最早时间戳之后的数据点才会具有异常情况检测结果。 最早的时间戳取决于数据的粒度。


      根据数据的粒度，将具有异常情况检测结果的历史数据的长度如下所示。


      | 粒度 | 用于异常情况检测的历史数据的最大长度 |

      | ----------- | ------------------------------------- |

      | 少于 5 分钟 | 加入时间 - 13 小时 |

      | 5 分钟至不到 1 小时 | 加入时间 - 4 天  |

      | 1 小时至不到 1 天 | 加入时间 - 14 天  |

      | 1 天 | 加入时间 - 28 天  |

      | 1 天以上，不到 31 天 | 加入时间 - 2 年  |

      | 大于 31 天 | 加入时间 - 24 年   |
  - question: >
      什么是指标顾问的数据保留和限制？
    answer: "1. 数据保留。\n指标顾问最多保留 10000 个时间间隔（什么是间隔？），从当前时间戳向前计数（无论是否有可用数据）。 超出此时间范围的数据将被删除。  数据保留映射的天数因指标粒度而异。\n\n| 粒度（分钟） |    保留（天） |\n|------------------| ------------------|\n|  1 | 6.94 |\n|  5 | 34.72|\n| 15 | 104.1|\n| 60（1 小时） | 416.67 |\n| 1440（1 天）|10000.00|\n\n2. 限制一个指标内的最大时序计数。\n\n一个指标内可能有多个维度，每个维度可能有多个值。 一个指标的最大维度组合不应超过 100k。   \n- 当数据馈送详细信息页上达到 80% 限制时，会通知指标顾问资源管理员和数据馈送所有者。 \n- 如果指标已经超出限制，数据馈送将暂停，并等待客户采取后续操作。 建议使用筛选将数据馈送拆分为多个数据馈送。 \n\n3. 一个指标顾问实例中存储的最大数据点的限制\n\n指标顾问从第一个引入时间戳开始，对加入到实例的所有数据馈送的数据点总数进行计数。 将存储到一个指标顾问实例中的最大数据点数是 20 亿。 \n- 当数据馈送列表页和添加新的数据馈送页上达到 80% 的限制时，将通知指标顾问资源管理员和所有用户。 \n- 如果数据点总数超过限制，则会暂停所有数据馈送并阻止新的馈送加入。 建议删除未使用的数据馈送，或者在订阅中创建新的指标顾问资源。\n"
  - question: >
      如何将峰值和低谷检测为异常？
    answer: >
      如果预定义了硬阈值，则实际上可以在[异常情况检测配置](how-tos/configure-metrics.md#anomaly-detection-methods)中手动设置“硬阈值”。

      如果没有阈值，则可以使用由 AI 提供支持的“智能检测”。 有关详细信息，请参阅[优化检测配置](how-tos/configure-metrics.md#tune-the-detection-configuration)。
  - question: >
      如何将常规（周期性）模式的不一致检测为异常？
    answer: >
      “智能检测”能够了解数据模式，包括周期性模式。 然后，它将那些不符合常规模式的数据点检测为异常。 有关详细信息，请参阅[优化检测配置](how-tos/configure-metrics.md#tune-the-detection-configuration)。
  - question: >
      如何将平线检测为异常？
    answer: >
      如果数据通常极不稳定且波动很大，你希望在数据变得十分稳定甚至变成一条平线时收到警告，则可以将“更改阈值”配置为在更改极小时检测此类数据点。

      有关详细信息，请参阅[异常情况检测配置](how-tos/configure-metrics.md#anomaly-detection-methods)。
  - question: >
      如何设置电子邮件设置并启用通过电子邮件发送警报的功能？
    answer: "1.  具有订阅管理员或资源组管理员权限的用户需要导航到在 Azure 门户中创建的指标顾问资源，并选择“访问控制(IAM)”选项卡。 \n2.  选择“添加角色分配”\n3.  选取“认知服务指标顾问管理员”角色，然后选择帐户，如下图所示。\n4.  单击“保存”按钮，你就会被成功地添加为指标顾问资源的管理员。 请注意，上述所有操作都需要由订阅管理员或资源组管理员执行。 \n\n    :::image type=\"content\" source=\"media/access-control.png\" alt-text=\"选择了“添加角色分配”的“访问控制(IAM)”菜单页，后跟一个显示“向选定用户分配访问权限”的框，其中包含“认知服务指标顾问管理员”访问角色，后跟所选 UI 的“保存”按钮，用于说明搜索用户和添加特定访问权限级别的步骤。\" lightbox=\"media/access-control.png\":::\n\n\n5.  传播权限最多可能需要一分钟时间。 然后，选择指标顾问工作区，并选择“电子邮件设置”选项（在左侧导航面板中）。 填写必需项，尤其是与 SMTP 相关的信息。 \n6.  选择“保存”，完成电子邮件配置。 你可以创建新的挂钩并订阅指标异常，以获得近乎实时的警报。 \n"
- name: 高级概念
  questions:
  - question: >
      指标顾问如何为多维指标构建诊断树？
    answer: "指标可以按维度划分为多个时序。 例如，为团队拥有的所有服务监视指标 `Response latency`。 可使用 `Service` 类别丰富指标的维度，因此我们按 `Service1` 和 `Service2` 等划分 `Response latency`。 每个服务都可以部署在多个数据中心的不同计算机上，因此可以按 `Machine` 和 `Data center` 进一步划分指标。\n\n|服务| 数据中心| 计算机  | \n|----|------|----------------   |\n| S1 |  DC1 |   M1 |\n| S1 |  DC1 |   M2 |\n| S1 |  DC2 |   M3 |\n| S1 |  DC2 |   M4 |\n| S2 |  DC1 |   M1 |\n| S2 |  DC1 |   M2 |\n| S2 |  DC2 |   M5 |\n| S2 |  DC2 |   M6 |\n| ...|      |      |\n\n从 `Response latency` 总数开始，我们可以按 `Service`、`Data center` 和 `Machine` 向下钻取指标。 但是，对于服务所有者而言，使用路径 `Service` -> `Data center` -> `Machine` 可能更有意义；而对于基础结构工程师而言，使用路径 `Data Center` -> `Machine` -> `Service` 可能更有意义。 这完全取决于用户的个人业务需求。 \n\n在指标顾问中，用户可以指定其要从分层拓扑的一个节点向下钻取或汇总的任何路径。 更准确地说，分层拓扑是有向无环图而非树结构。 完整的分层拓扑由所有潜在的维度组合组成，如下所示： \n\n:::image type=\"content\" source=\"media/dimension-combinations-view.png\" alt-text=\"分层拓扑图，由多个相互连接的顶点和边组成，这些顶点和边的维度标注为 S、DC 和 M，其对应数字范围为 1 到 6\" lightbox=\"media/dimension-combinations-view.png\":::\n\n从理论上讲，如果维度 `Service` 具有 `Ls` 个非重复值，维度 `Data center` 具有 `Ldc` 个非重复值，维度 `Machine` 具有 `Lm` 个非重复值，则分层拓扑中可能有 `(Ls + 1) * (Ldc + 1) * (Lm + 1)` 个维度组合。 \n\n但通常并非所有维度组合都是有效的，这可能会显着降低复杂性。 目前，如果用户自己聚合指标，则不限制维度的数量。 如果需要使用指标顾问提供的汇总功能，则维度的数量不应超过 6。 但是，我们将按指标维度扩展的时序数量限制为小于 10,000。\n\n诊断页上的“诊断树”工具仅显示在其中检测到异常的节点，而不是整个拓扑。 这是为了帮助你专注于当前问题。 它也可能会不显示指标内的所有异常，而是会基于贡献显示最常见的异常。 这样，我们可以快速找出异常数据的影响、范围和传播路径。 这大大减少了需要重点关注的异常数量，并帮助用户了解并找到其关键问题。 \n \n例如，当 `Service = S2 | Data Center = DC2 | Machine = M5` 上发生异常时，异常的偏差会影响也已检测到异常的父节点 `Service= S2`，但异常不会影响 `DC2` 上的整个数据中心以及 `M5` 上的所有服务。 将按照以下屏幕截图中的方式构建事件树，最常见的异常是在 `Service = S2` 上捕获的，根本原因可以按两条通向 `Service = S2 | Data Center = DC2 | Machine = M5` 的路径进行分析。\n\n :::image type=\"content\" source=\"media/root-cause-paths.png\" alt-text=\"5 个标记的顶点，有两条不同的路径，这些路径通过边与标记为 S2 的公共节点相连。最常见的异常是在 Service = S2 上捕获的，根本原因可以按两条通向 Service = S2 | Data Center = DC2 | Machine = M5 的路径进行分析\" lightbox=\"media/root-cause-paths.png\":::\n"
additionalContent: "\n## <a name=\"next-steps\"></a>后续步骤\n\n- [指标顾问概述](overview.md)"
