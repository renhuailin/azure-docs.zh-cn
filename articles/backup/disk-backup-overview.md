---
title: Azure 磁盘备份概述
description: 了解 Azure 磁盘备份解决方案。
ms.topic: conceptual
ms.date: 04/09/2021
ms.openlocfilehash: 42f37c1f500be719e0bd79bad41226ab3ab2d911
ms.sourcegitcommit: c6a2d9a44a5a2c13abddab932d16c295a7207d6a
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/09/2021
ms.locfileid: "107285133"
---
# <a name="overview-of-azure-disk-backup"></a>Azure 磁盘备份概述

Azure 磁盘备份是基于云的本机备份解决方案，可保护托管磁盘中的数据。 它是一个简单、安全且经济高效的解决方案，使你能够通过几个步骤为托管磁盘配置保护。 它确保你可以在灾难情况下恢复数据。

Azure 磁盘备份提供了一个统包式解决方案，通过自动定期创建快照并使用备份策略在配置的时间段内保留快照，为托管磁盘提供快照生命周期管理。 无需对基础结构投入任何资金，无需编写任何自定义脚本，无需产生任何管理开销，就能管理磁盘快照。 它是一个使用[增量快照](../virtual-machines/disks-incremental-snapshots.md)创建托管磁盘时间点备份的崩溃一致性备份解决方案，支持每日创建多个备份。 它也是一个无代理解决方案，不会影响生产应用程序的性能。 它支持备份和还原 OS 磁盘与数据磁盘（包括共享磁盘），不管这些磁盘当前是否已附加到正在运行的 Azure 虚拟机。

如果需要包含数据磁盘的虚拟机的应用程序一致性备份，或者从备份中还原整个虚拟机的选项，请还原文件或文件夹，或还原到次要区域，然后使用 [Azure VM 备份](backup-azure-vms-introduction.md)解决方案。 除了 [Azure VM 备份](./backup-azure-vms-introduction.md)解决方案，Azure 备份还使用磁盘备份为托管磁盘的备份提供并行支持。 当你需要每天一次的应用程序一致性虚拟机备份，以及需要更频繁地备份崩溃一致性且不会影响生产应用程序性能的 OS 磁盘或特定数据磁盘时，此解决方案非常有用。

Azure 磁盘备份集成在备份中心中，可在 Azure 中提供单一的统一管理体验，使企业能够大规模治理、监视、操作和分析备份。

## <a name="key-benefits-of-disk-backup"></a>磁盘备份的主要优势

Azure 磁盘备份是无代理的崩溃一致性解决方案，它使用[增量快照](../virtual-machines/disks-incremental-snapshots.md)并提供以下优点：

- 更频繁、更快速地备份，而不会中断虚拟机。
- 不会影响生产应用程序的性能。
- 无安全问题，因为它不需要运行自定义脚本或安装代理。
- 与备份整个虚拟机相比，它是用于备份特定磁盘的经济高效的解决方案。

Azure 磁盘备份解决方案在以下情况下很有用：

- 需要每天频繁备份，无需让应用程序处于静止状态。
- 在群集场景中运行的应用：Windows Server 故障转移群集和 Linux 群集都写入共享磁盘。
- 出于应用程序的安全或性能考虑，明确需要进行无代理备份。
- VM 的应用程序一致性备份并不可行，因为业务线应用不支持卷影复制服务 (VSS)。

在以下情况下，请考虑使用 Azure 磁盘备份：

- 任务关键应用程序运行在 Azure 虚拟机上，该虚拟机要求每天进行多次备份来满足恢复点目标，而又不影响生产环境或应用程序性能。
- 出于安全考虑，你的组织或行业法规会限制安装代理。
- 在 Linux 虚拟机上执行自定义的前处理或后处理脚本并调用冻结和解冻以获取应用程序一致性备份，这会在生产工作负载可用性方面产生不必要的开销。
- 在 Azure Kubernetes 服务（AKS 群集）上运行的容器化应用程序正在使用托管磁盘作为持久存储。 现在，必须通过难以管理的自动化脚本来备份托管磁盘。
- 托管磁盘包含关键业务数据（用作文件共享）或包含数据库备份文件，并且你希望通过不投资于 Azure 虚拟机备份来优化备份成本。
- 你有多个 Linux 和 Windows 单磁盘虚拟机（即仅具有一个 OS 磁盘且未附加数据磁盘的虚拟机）托管 Web 服务器或无状态计算机，或作为具有应用程序配置设置的过渡环境，你需要一种经济高效的备份解决方案来保护该 OS 磁盘。 例如，在升级或修补虚拟机之前触发快速按需备份。
- 虚拟机正在运行 Azure 虚拟机备份解决方案不支持的 OS 配置（例如，Windows 2008 32 位服务器）。

## <a name="how-the-backup-and-restore-process-works"></a>备份和还原过程的工作方式

- 配置 Azure 托管磁盘的备份的第一步是创建[备份保管库](backup-vault-overview.md)。 保管库提供为各种工作负载配置的备份的合并视图。

- 然后，创建一个允许你配置备份频率和保留期的备份策略。

- 若要配置备份，请前往备份保管库，分配备份策略，选择需要备份的托管磁盘，并提供要在其中存储和管理快照的资源组。 Azure 备份会自动触发计划的备份作业，这些作业根据备份频率创建磁盘的增量快照。 根据备份策略指定的保留期，删除较旧的快照。

- Azure 备份使用托管磁盘的[增量快照](../virtual-machines/disks-incremental-snapshots.md#restrictions)。 增量快照是托管磁盘的一种经济高效的时间点备份，该备份针对自上次快照以来对磁盘的增量更改计费。 无论父磁盘的存储类型如何，它们始终存储在最经济高效的存储空间（标准 HDD 存储）中。 磁盘的第一个快照将占用磁盘的已用大小，并且连续增量快照会将自上次快照以来的增量更改存储到磁盘。

- 配置托管磁盘的备份后，将在备份保管库中创建一个备份实例。 通过使用该备份实例，可以查找备份操作的运行状况，触发按需备份以及执行还原操作。 还可以通过使用备份中心来查看跨多个保管库和备份实例的备份的运行状况，该备份中心提供了单一虚拟管理平台视图。

- 若要还原，只需选择要从中还原磁盘的恢复点。 提供要在其中从快照创建已还原磁盘的资源组。 Azure 备份提供即时还原体验，因为快照本地存储在订阅中。

- 备份保管库使用托管标识来访问其他 Azure 资源。 若要配置托管磁盘的备份并从过去的备份进行还原，备份保管库的托管标识需要对源磁盘、在其中创建和管理快照的快照资源组以及要在其中还原备份的目标资源组具有一组权限。 可使用 Azure 基于角色的访问控制 (Azure RBAC) 来授予托管标识的访问权限。 托管标识是一种只能用于 Azure 资源的特殊类型的服务主体。 详细了解[托管标识](../active-directory/managed-identities-azure-resources/overview.md)。

- 目前，Azure 磁盘备份支持托管磁盘的操作备份，不会将备份复制到备份保管库存储中。 有关支持和不支持的方案的详细列表和区域可用性，请参阅[支持矩阵](disk-backup-support-matrix.md)。

## <a name="pricing"></a>定价

Azure 备份提供用于保护 Azure 磁盘的快照生命周期管理解决方案。 Azure 备份创建的磁盘快照存储在 Azure 订阅中的资源组中，并产生快照存储费用。 若要详细了解快照定价，可以访问[托管磁盘定价](https://azure.microsoft.com/pricing/details/managed-disks/)。<br></br>由于快照不会复制到备份保管库，Azure 备份不会对受保护的实例收取费用，并且不会收取备份存储费用。 此外，增量快照自上次快照以来占用增量更改，并且无论父托管磁盘的存储类型如何，增量快照始终存储在标准存储中，并根据标准存储的定价收费。 这使得 Azure 磁盘备份成为经济高效的解决方案。

## <a name="next-steps"></a>后续步骤

[Azure 磁盘备份支持矩阵](disk-backup-support-matrix.md)
