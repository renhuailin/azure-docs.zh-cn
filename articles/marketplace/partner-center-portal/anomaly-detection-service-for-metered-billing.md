---
title: 针对按流量计费的异常情况检测服务 - Microsoft Azure 市场
description: 介绍异常检测的工作原理、发送通知的时间以及如何处理通知以及支持选项。
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: conceptual
ms.author: mingshen
author: mingshen-ms
ms.date: 06/10/2020
ms.openlocfilehash: 8c0cba39c2fe299a2cc822309b0063d2d4fe2f71
ms.sourcegitcommit: beff1803eeb28b60482560eee8967122653bc19c
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/07/2021
ms.locfileid: "113431512"
---
# <a name="anomaly-detection-service-for-metered-billing"></a>针对按流量计费的异常情况检测服务

[市场计量服务](../marketplace-metering-service-apis-faq.yml)使你可以在商业市场计划中创建基于非标准单位收费的产品/服务。 通过按流量计费，你可以将客户使用情况的使用情况事件发送到 Microsoft，并根据该使用情况准备计费。

错误的使用情况数据可能由多种原因所致，例如 bug、消耗跟踪中的错误配置或欺诈行为。 使用情况数据不正确会导致客户费用不正确和计费争议。

为了缓解该风险，我们的异常情况检测服务会应用机器学习算法来确定正常的按流量计费行为、分析按流量计费的使用情况，并以最少的用户干预发现异常。

如果在按流量计费的使用情况中检测到异常，则会通知你。 这使你有机会调查并在确认问题的真实性后通知我们，此时可以采取相应措施主动解决客户的计费问题。

对于按流量计费的使用情况，除了突然出现峰值、骤降和趋势变化之外，我们的模型还考虑了季节性影响。 由于按流量计费通过超额数据进行通信，因此，模型还能够很好地处理长时间的数据丢失。

下面是异常检测结果的示例。 预期范围显示为黄色带。 可接受的按流量计费使用情况在带中显示为绿色的星。 带以外的计费使用情况显示为红点。  

在可预测趋势之外检测到的异常：

![显示在可预测趋势之外检测到的异常。](media/anomaly-1.png)

在重复循环趋势以外检测到的异常：

![显示在重复循环趋势以外检测到的异常。](media/anomaly-2.png)

在向上趋势中检测到的异常：

![显示在向上趋势中检测到的异常。](media/anomaly-3.png)

## <a name="how-anomaly-detection-service-works"></a>异常情况检测服务的工作原理

对于所有按流量计费的使用情况，会自动启用异常情况检测。 将使用情况事件提交到 Microsoft 时，异常情况检测服务会基于过去的使用情况数据创建预期值的模型。 此模型每周运行一次。

异常情况检测在按计量和按客户级别工作。 这意味着，每个客户的每个计量都有一个基于根据该客户过去的计量使用模式训练的模型。

该模型的工作原理是生成追溯置信区间。 时序预测是一种通用加法模型，由趋势预测部分和季节性部分组成。 由于该模型被制定为回归任务，因此可以很好地处理长时间的数据丢失。 如果观察值超出预测的置信区间，则意味着无法根据按流量计费的历史模式解释观察值，因此可能是异常。

## <a name="anomaly-detection-notification"></a>异常情况检测通知

你可以评估、管理和确认合作伙伴中心中的异常。 要了解具体做法，请参阅[在合作伙伴中心管理按流量计费的异常](../anomaly-detection.md)。

若要确保不会超额计费客户的按流量计费的使用情况，应调查所检测到的异常的真实性。 如果真实存在，则可以在合作伙伴中心中确认错误的使用情况。

建议确认检测到的异常是否是正常的使用情况。 这样做将改进我们所提供的异常数据。 如果异常表示潜在的高财务风险，我们可能会联系你确认该使用情况。

## <a name="when-and-how-to-get-support"></a>何时以及如何获取支持

如果你向我们发送的按流量计费的使用情况有误，并已导致或将导致对客户少收费，我们不会就少报的使用情况向该客户发送帐单，也不就该使用情况向你付费。 你必须自行承担由于少报而导致的收入损失。

如果出现以下情况之一，你可以调整合作伙伴中心中的使用情况量，这将导致对客户退款或计费调整：

- 你确认我们发现的其中一项异常真实存在且使用情况误报导致客户超额付费。
- 你发现向我们发送的使用情况有误，并且错误的使用情况导致向客户超额收费。

提交与按流量计费异常相关的支持票证：

1. 用你的工作帐户登录到[合作伙伴中心](https://go.microsoft.com/fwlink/?linkid=2165290)。
1. 在页面右上角的菜单中，选择“支持”图标。 “帮助和支持”窗格显示在页面的右侧。
1. 要获得有关商业市场的帮助，请选择“商业市场”。
   ![显示“支持”窗格。](../media/support/commercial-marketplace-support-pane.png)
1. 在“问题摘要”框中，输入“商业市场 > 按流量计费”。
1. 在“问题类型”框中，选择以下任一项：
    - 商业市场 > 按流量计费 > 发送的 Azure 应用程序产品/服务使用情况有误
    - 商业市场 > 按流量计费 > 发送的 SaaS 产品/服务使用情况有误
1. 在“下一步”中，选择“查看解决方案”。
1. 查看建议的文档（如果有），或选择“提供问题详细信息”以提交支持票证。

有关更多发布者支持选项，请参阅[合作伙伴中心对商业市场计划的支持](../support.md)。

## <a name="next-steps"></a>后续步骤

- 了解[市场计量服务 API](../marketplace-metering-service-apis.md)。
- 请参阅[在合作伙伴中心管理按流量计费的异常](../anomaly-detection.md)