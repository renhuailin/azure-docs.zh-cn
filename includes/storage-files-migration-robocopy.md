---
title: include 文件
description: include 文件
services: storage
author: fauhse
ms.service: storage
ms.topic: include
ms.date: 4/05/2021
ms.author: fauhse
ms.custom: include file
ms.openlocfilehash: 8b425646e9b416129d951cc78db3d05c26b0e6e8
ms.sourcegitcommit: e8b229b3ef22068c5e7cd294785532e144b7a45a
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/04/2021
ms.locfileid: "123483832"
---
```console
robocopy /MT:128 /R:1 /W:1 /B /MIR /IT /COPY:DATSO /DCOPY:DAT /NP /NFL /NDL /UNILOG:<FilePathAndName> <SourcePath> <Dest.Path> 
```

| 开关                | 含义 |
|-----------------------|---------|
| `/MT:n`               | 允许 Robocopy 以多线程方式运行。 `n` 的默认值为 8。 最大线程数为 128 个。 在初始运行时，以较高的线程数开始。 较高的线程数有助于使可用带宽饱和。 后续的 `/MIR` 运行会逐步受到可用计算与可用网络带宽的影响。 对于后续的运行，请让你的线程计数值尽量与处理器核心计数和每个核心的线程计数匹配。 考虑是否需要为生产服务器可能具有的其他任务预留核心。 |
| `/R:n`                | 第一次尝试复制失败的文件的最大重试计数。 可以通过指定在运行中文件复制永久失败之前的最大重试次数 (`n`) 来提高 Robocopy 的运行速度。 在已明确会有更多 RoboCopy 运行的情况下，此开关将起作用。 如果文件在当前运行中复制失败，则下一个 RoboCopy 作业将重试。 由于正在使用或超时问题而失败的文件最终可能会成功复制（如果你使用此方法）。 |
| `/W:n`                | 指定在尝试复制上一次复制尝试未成功的文件之前 Robocopy 等待的时间。 `n` 是两次重试之间的等待间隔（秒）。 `/W:n` 通常与 `/R:n` 一起使用。 |
| `/B`                  | 在备份应用程序会使用的同一模式下运行 Robocopy。 此开关允许 Robocopy 移动当前用户无权访问的文件。 |
| `/MIR`                | （将源镜像映射到目标）使 Robocpy 只复制源和目标之间的增量。 将复制空子目录。 将复制目标上已更改或不存在的项（文件或文件夹）。 将从目标上清除（删除）目标上存在但源上没有的项。 使用此开关时，要使源和目标文件夹结构完全匹配。 “匹配”表示从正确的源和文件夹级别复制到目标上的匹配文件夹级别。 只有这样，才能成功完成“追赶”复制。 当源和目标不匹配时，使用 `/MIR` 将导致大规模删除和重新复制。 |
| `/IT`                 | 确保在某些镜像方案中保留保真度。 </br>例如，如果在两个 RoboCopy 运行之间，文件遇到 ACL 更改和属性更新的情况，它将被标记为“隐藏”。 如果没有 `/IT`，RoboCopy 可能会遗漏 ACL 更改，并且不会将其传输到目标位置。 |
|`/COPY:[copyflags]`    | 文件副本的保真度。 默认值：`/COPY:DAT`。 复制标记：`D`= 数据，`A`= 属性，`T`= 时间戳，`S`= 安全性 = NTFS ACL，`O`= 所有者信息，`U`= 审核信息<u></u>。 审核信息无法存储在 Azure 文件共享中。 |
| `/DCOPY:[copyflags]`  | 目录副本的保真度。 默认值：`/DCOPY:DA`。 复制标记：`D` = 数据，`A` = 属性，`T` = 时间戳。 |
| `/NP`                 | 指定不显示每个文件和文件夹的复制进度。 显示进度会明显降低复制性能。 |
| `/NFL`                | 指定不记录文件名。 提高复制性能。 |
| `/NDL`                | 指定不记录目录名。 提高复制性能。 |
| `/UNILOG:<file name>` | 将状态以 Unicode 形式写入日志文件。 （覆盖现有日志。） |
| `/L`                  | 仅适用于测试运行 </br> 文件只是会被列出。 它们不会被复制，也不会被删除，并且也不会有时间戳。 通常与 `/TEE` 配合使用以获得控制台输出。 可能需要删除示例脚本中的标志（例如 `/NP`、`/NFL` 和 `/NDL`），才能正确记录测试结果。 |
| `/LFSM`               | **仅适用于具有分层存储的目标** </br>指定 Robocopy 在“低可用空间模式”下运行。 此开关仅对具有分层存储的目标有用，这些目标可能会在 Robocopy 完成之前耗尽本地容量。 它是专门为启用 Azure 文件同步云分层的目标而添加的。 它可独立于 Azure 文件同步使用。在此模式下，每当文件复制会导致目标卷的可用空间低于“下限”值时，Robocopy 都会暂停。 可通过标志的 `/LFSM:n` 形式指定此值。 参数 `n` 在基数 2 `nKB`、`nMB` 或 `nGB` 中指定。 如果指定的 `/LFSM` 没有明确的下限值，则下限将设置为目标卷大小的 10%。 低可用空间模式与 `/MT`、`/EFSRAW`、`/B` 或 `/ZB` 不兼容。 |
| `/Z`                  | **谨慎使用** </br>在重启模式下复制文件。 只有在不稳定的网络环境下，才建议使用此开关。 由于额外的日志记录，此开关会明显降低复制性能。 |
| `/ZB`                 | **谨慎使用** </br>使用重启模式。 如果访问被拒绝，此选项将使用备份模式。 由于检查点，此选项会明显降低复制性能。 |

> [!IMPORTANT]
> 使用至少具有 2021 年 8 月 26 日的 [OS 更新 KB5005103](https://support.microsoft.com/topic/august-26-2021-kb5005103-os-build-18363-1766-preview-4e23362c-5e43-4d8f-95e5-9fdade60605f) 的 Windows Server 2019。 它包含对某些 RoboCopy 方案的重要修补程序。
